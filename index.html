<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeltaPro | Sovereign Compliance Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                fontFamily: { sans: ['Inter', 'sans-serif'], mono: ['JetBrains Mono', 'monospace'] },
                extend: {
                    colors: {
                        background: '#09090b',
                        surface: '#18181b',
                        surfaceHighlight: '#27272a',
                        border: '#27272a',
                        primary: '#f59e0b', /* Changed to Amber/Gold for "Sovereign/Gold" feel */
                        primaryDim: 'rgba(245, 158, 11, 0.1)',
                        success: '#10b981',
                        danger: '#ef4444'
                    }
                }
            }
        }
    </script>
    <style>
        body { background-color: #09090b; color: #e4e4e7; }
        .glass { background: rgba(24, 24, 27, 0.7); backdrop-filter: blur(8px); }
        .sidebar-link.active { background: #27272a; color: white; border-right: 2px solid #f59e0b; }
        .score-card { background: linear-gradient(145deg, #18181b, #0f0f11); }
        
        /* B-BBEE Level Badge Animation */
        .level-badge { animation: pulse-gold 3s infinite; }
        @keyframes pulse-gold { 0% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(245, 158, 11, 0); } 100% { box-shadow: 0 0 0 0 rgba(245, 158, 11, 0); } }
    </style>
</head>
<body class="h-screen flex overflow-hidden text-sm">

    <aside class="w-64 border-r border-border bg-surface flex flex-col z-20">
        <div class="h-16 flex items-center gap-3 px-6 border-b border-border">
            <div class="w-8 h-8 bg-gradient-to-br from-amber-400 to-amber-600 rounded flex items-center justify-center text-black text-xs font-bold shadow-lg shadow-amber-900/20">D</div>
            <div class="flex flex-col">
                <span class="font-bold tracking-tight text-white leading-none">DeltaPro</span>
                <span class="text-[10px] text-zinc-500 font-normal mt-1">ZA ENTERPRISE</span>
            </div>
        </div>

        <div class="p-3 flex-1 overflow-y-auto">
            <div class="mb-6">
                <div class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider mb-2 px-2">Core Intelligence</div>
                <button onclick="App.navigate('dashboard')" class="sidebar-link active w-full text-left px-3 py-2 rounded-md text-zinc-400 hover:text-white hover:bg-surfaceHighlight transition flex items-center gap-3">
                    <i class="fa-solid fa-chart-pie w-4"></i> Executive View
                </button>
                <button onclick="App.navigate('inference')" class="sidebar-link w-full text-left px-3 py-2 rounded-md text-zinc-400 hover:text-white hover:bg-surfaceHighlight transition flex items-center gap-3">
                    <i class="fa-solid fa-microchip w-4"></i> Skill Inference
                </button>
            </div>

            <div class="mb-6">
                <div class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider mb-2 px-2 text-amber-500">Compliance & Governance</div>
                <button onclick="App.navigate('compliance')" class="sidebar-link w-full text-left px-3 py-2 rounded-md text-zinc-400 hover:text-white hover:bg-surfaceHighlight transition flex items-center gap-3">
                    <i class="fa-solid fa-scale-balanced w-4 text-amber-500"></i> B-BBEE Scorecard
                </button>
                <button onclick="App.navigate('directory')" class="sidebar-link w-full text-left px-3 py-2 rounded-md text-zinc-400 hover:text-white hover:bg-surfaceHighlight transition flex items-center gap-3">
                    <i class="fa-solid fa-id-card w-4"></i> Talent Wallets
                </button>
            </div>

            <div class="mb-4">
                <div class="text-[10px] font-bold text-zinc-500 uppercase tracking-wider mb-2 px-2">System</div>
                <button onclick="App.navigate('settings')" class="sidebar-link w-full text-left px-3 py-2 rounded-md text-zinc-400 hover:text-white hover:bg-surfaceHighlight transition flex items-center gap-3">
                    <i class="fa-solid fa-shield-halved w-4"></i> AtHash Privacy
                </button>
            </div>
        </div>

        <div class="p-4 border-t border-border bg-black/20">
            <div class="flex items-center justify-between text-[10px] text-zinc-500">
                <span>Server: JNB-1 (South Africa)</span>
                <span class="w-2 h-2 rounded-full bg-green-500"></span>
            </div>
        </div>
    </aside>

    <main class="flex-1 flex flex-col relative bg-background">
        
        <header class="h-16 border-b border-border flex items-center justify-between px-8 bg-background/50 backdrop-blur sticky top-0 z-10">
            <div class="flex flex-col">
                <span id="page-title" class="font-bold text-lg text-white">Dashboard</span>
                <span id="page-subtitle" class="text-xs text-zinc-500">Overview of organizational capability</span>
            </div>
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center gap-2 px-3 py-1 bg-surface border border-amber-900/30 rounded-full">
                    <span class="w-2 h-2 rounded-full bg-amber-500 animate-pulse"></span>
                    <span class="text-xs text-amber-500 font-medium">Compliance Audit Active</span>
                </div>
                <button class="w-10 h-10 flex items-center justify-center text-zinc-400 hover:text-white bg-surface rounded-full border border-border">
                    <i class="fa-regular fa-bell"></i>
                </button>
            </div>
        </header>

        <div id="app-view" class="flex-1 overflow-y-auto p-8">
            </div>

    </main>

    <script>
        // --- 1. MOCK DATA LAYER (SA Contextualized) ---
        const DB = {
            users: Array.from({ length: 15 }, (_, i) => ({
                id: `ZA-${202400 + i}`,
                name: ['Thabo Mokoena', 'Sarah Van Der Merwe', 'Keshav Naidoo', 'Lindiwe Zulu', 'James Stirling'][i % 5] + ` ${i}`,
                role: ['Python Engineer', 'Solutions Arch', 'Data Analyst', 'Product Owner', 'DevOps Lead'][i % 5],
                race: ['African', 'White', 'Indian', 'African', 'White'][i % 5],
                gender: ['Male', 'Female', 'Male', 'Female', 'Male'][i % 5],
                skillSpend: Math.floor(Math.random() * (50000 - 5000) + 5000), // R5000 - R50000
                verifiedSkills: Math.floor(Math.random() * 12) + 3,
                status: 'Active'
            })),
            financials: {
                target: 6000000, // R6 Million target
                current: 4250000  // R4.25 Million spent
            }
        };

        // --- 2. FORMATTERS ---
        const Format = {
            currency: (val) => new Intl.NumberFormat('en-ZA', { style: 'currency', currency: 'ZAR', maximumFractionDigits: 0 }).format(val)
        };

        // --- 3. VIEWS ---
        const Views = {
            dashboard: () => `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="score-card p-6 rounded-xl border border-border relative overflow-hidden group">
                        <div class="absolute right-0 top-0 p-4 opacity-10 group-hover:opacity-20 transition"><i class="fa-solid fa-users text-6xl text-white"></i></div>
                        <div class="text-zinc-500 text-xs font-bold uppercase mb-2">Total Verified Talent</div>
                        <div class="text-4xl font-bold text-white">${DB.users.length * 84}</div>
                        <div class="text-xs text-green-500 mt-2 font-medium">94% Verification Rate</div>
                    </div>
                    
                    <div class="score-card p-6 rounded-xl border border-amber-900/50 relative overflow-hidden">
                        <div class="absolute right-0 top-0 p-4 opacity-10"><i class="fa-solid fa-award text-6xl text-amber-500"></i></div>
                        <div class="text-amber-500 text-xs font-bold uppercase mb-2">Skills Development Spend (YTD)</div>
                        <div class="text-4xl font-bold text-white">${Format.currency(DB.financials.current)}</div>
                        <div class="w-full bg-zinc-800 h-1.5 mt-3 rounded-full overflow-hidden">
                            <div class="bg-amber-500 h-full" style="width: ${(DB.financials.current / DB.financials.target) * 100}%"></div>
                        </div>
                        <div class="text-xs text-zinc-500 mt-1 flex justify-between">
                            <span>Progress to Target</span>
                            <span>${Math.round((DB.financials.current / DB.financials.target) * 100)}%</span>
                        </div>
                    </div>

                    <div class="score-card p-6 rounded-xl border border-border relative overflow-hidden">
                        <div class="text-zinc-500 text-xs font-bold uppercase mb-2">Critical Shortage Risks</div>
                        <div class="text-4xl font-bold text-red-500">3</div>
                        <div class="text-xs text-zinc-400 mt-2">Senior Python Backend (2), DevOps (1)</div>
                        <button class="mt-4 text-xs bg-red-500/10 text-red-500 px-3 py-1.5 rounded border border-red-500/20 hover:bg-red-500 hover:text-white transition">View Recruitment Plan</button>
                    </div>
                </div>

                <div class="bg-surface border border-border rounded-xl p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="font-bold text-white">Real-Time Capability Heatmap</h3>
                        <div class="flex gap-2">
                            <span class="px-2 py-1 bg-zinc-800 text-xs rounded text-zinc-400">Engineering</span>
                            <span class="px-2 py-1 bg-zinc-800 text-xs rounded text-zinc-400">Product</span>
                        </div>
                    </div>
                    <div class="h-80 w-full">
                        <canvas id="skillChart"></canvas>
                    </div>
                </div>
            `,

            compliance: () => `
                <div class="grid lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2 space-y-6">
                        <div class="bg-surface border border-border rounded-xl p-8 flex items-center justify-between bg-gradient-to-r from-surface to-amber-900/10">
                            <div>
                                <h2 class="text-2xl font-bold text-white">B-BBEE Skills Scorecard</h2>
                                <p class="text-zinc-400 text-sm mt-1">Projected Level based on current verified training data.</p>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-amber-500 font-bold uppercase tracking-widest mb-1">Projected Level</div>
                                <div class="w-16 h-16 rounded-full border-4 border-amber-500 flex items-center justify-center text-2xl font-bold text-white bg-black level-badge">2</div>
                            </div>
                        </div>

                        <div class="bg-surface border border-border rounded-xl p-6">
                            <h3 class="font-bold text-white mb-4">EAP Targets (Economically Active Population)</h3>
                            <table class="w-full text-left text-sm">
                                <thead class="text-xs text-zinc-500 uppercase bg-zinc-900/50">
                                    <tr>
                                        <th class="p-3 rounded-l">Demographic</th>
                                        <th class="p-3">Current Headcount</th>
                                        <th class="p-3">Skills Spend</th>
                                        <th class="p-3 rounded-r">Target Status</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-zinc-800">
                                    <tr>
                                        <td class="p-3 font-medium text-white">African (Male)</td>
                                        <td class="p-3">42%</td>
                                        <td class="p-3 text-white">${Format.currency(1200000)}</td>
                                        <td class="p-3"><span class="text-green-500 text-xs bg-green-500/10 px-2 py-1 rounded border border-green-500/20">On Track</span></td>
                                    </tr>
                                    <tr>
                                        <td class="p-3 font-medium text-white">African (Female)</td>
                                        <td class="p-3">38%</td>
                                        <td class="p-3 text-white">${Format.currency(950000)}</td>
                                        <td class="p-3"><span class="text-amber-500 text-xs bg-amber-500/10 px-2 py-1 rounded border border-amber-500/20">Near Target</span></td>
                                    </tr>
                                    <tr>
                                        <td class="p-3 font-medium text-white">Indian/Coloured</td>
                                        <td class="p-3">12%</td>
                                        <td class="p-3 text-white">${Format.currency(400000)}</td>
                                        <td class="p-3"><span class="text-green-500 text-xs bg-green-500/10 px-2 py-1 rounded border border-green-500/20">Compliant</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="space-y-6">
                         <div class="bg-surface border border-border rounded-xl p-6">
                            <h3 class="font-bold text-white mb-4">Required Actions</h3>
                            <ul class="space-y-3">
                                <li class="flex gap-3 items-start">
                                    <i class="fa-solid fa-triangle-exclamation text-amber-500 mt-1"></i>
                                    <div>
                                        <div class="text-sm text-white">Increase Learnederships</div>
                                        <div class="text-xs text-zinc-500">Shortfall of R450k in Cat B/C training for Junior African Females.</div>
                                    </div>
                                </li>
                                <li class="flex gap-3 items-start">
                                    <i class="fa-regular fa-file-pdf text-zinc-400 mt-1"></i>
                                    <div>
                                        <div class="text-sm text-white">Generate Audit Pack</div>
                                        <div class="text-xs text-zinc-500">Prepare WSP/ATR submission for SETA.</div>
                                        <button class="mt-2 text-xs w-full py-1 bg-zinc-800 border border-zinc-700 rounded hover:text-white transition">Download PDF</button>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            `,

            directory: () => `
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-white">Verified Talent Wallets</h2>
                    <div class="flex gap-2">
                        <button class="px-3 py-1.5 bg-zinc-800 border border-zinc-700 rounded text-xs text-white">Export to CSV</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    ${DB.users.map(u => `
                        <div class="bg-surface border border-border p-4 rounded-xl hover:border-zinc-500 transition group cursor-pointer">
                            <div class="flex justify-between items-start mb-4">
                                <div class="flex gap-3">
                                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-zinc-700 to-zinc-800 flex items-center justify-center text-xs font-bold text-zinc-400 border border-zinc-600">${u.name.charAt(0)}</div>
                                    <div>
                                        <div class="text-sm font-bold text-white">${u.name}</div>
                                        <div class="text-xs text-zinc-500">${u.role}</div>
                                    </div>
                                </div>
                                <i class="fa-solid fa-shield-check text-green-500" title="Identity Verified by AtHash"></i>
                            </div>
                            <div class="space-y-2">
                                <div class="flex justify-between text-xs">
                                    <span class="text-zinc-500">Verified Skills</span>
                                    <span class="text-white font-mono">${u.verifiedSkills}</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-zinc-500">Skills Spend (YTD)</span>
                                    <span class="text-amber-500 font-mono">${Format.currency(u.skillSpend)}</span>
                                </div>
                                <div class="flex justify-between text-xs">
                                    <span class="text-zinc-500">Equity Category</span>
                                    <span class="text-zinc-400">${u.race} / ${u.gender}</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `,
            
            inference: () => `
                <div class="max-w-2xl mx-auto text-center pt-10">
                    <div class="w-20 h-20 bg-zinc-800 rounded-2xl mx-auto flex items-center justify-center mb-6 relative">
                        <div class="absolute inset-0 bg-amber-500/20 blur-xl rounded-full"></div>
                        <i class="fa-solid fa-brain text-4xl text-amber-500 relative z-10"></i>
                    </div>
                    <h2 class="text-3xl font-bold text-white mb-4">Vector Skill Contextualization</h2>
                    <p class="text-zinc-400 mb-8">DeltaPro uses RAG (Retrieval-Augmented Generation) to infer skills from GitHub commits, Jira tickets, and Slack velocityâ€”not just keywords.</p>
                    
                    <div class="bg-surface border border-dashed border-zinc-700 rounded-xl p-12 hover:border-amber-500 transition cursor-pointer group">
                        <i class="fa-solid fa-upload text-3xl text-zinc-500 group-hover:text-amber-500 mb-4 transition"></i>
                        <h3 class="text-white font-medium">Upload Project Manifest or Repo Link</h3>
                        <p class="text-xs text-zinc-500 mt-2">Connecting to Vector DB (Pinecone) via Zaziza Private Cloud...</p>
                    </div>
                </div>
            `,

            settings: () => `
                <div class="max-w-3xl">
                    <h2 class="text-xl font-bold text-white mb-6">Privacy & Sovereignty</h2>
                    <div class="bg-surface border border-border rounded-xl p-6 mb-6">
                        <h3 class="font-bold text-white mb-2">AtHash Anonymization Layer</h3>
                        <p class="text-sm text-zinc-400 mb-4">Ensure compliance with POPIA Act 4 of 2013 by masking PII before inference.</p>
                        
                        <div class="flex items-center justify-between py-3 border-b border-zinc-800">
                            <span class="text-sm text-white">Mask Employee Names</span>
                            <i class="fa-solid fa-toggle-on text-2xl text-green-500 cursor-pointer"></i>
                        </div>
                         <div class="flex items-center justify-between py-3 border-b border-zinc-800">
                            <span class="text-sm text-white">Mask Salary/Financial Data</span>
                            <i class="fa-solid fa-toggle-on text-2xl text-green-500 cursor-pointer"></i>
                        </div>
                        <div class="flex items-center justify-between py-3">
                            <span class="text-sm text-white">Data Residency</span>
                            <span class="text-xs bg-zinc-800 px-2 py-1 rounded text-zinc-400">Cape Town (AWS af-south-1)</span>
                        </div>
                    </div>
                </div>
            `
        };

        // --- 4. CONTROLLER ---
        const App = {
            init() {
                this.navigate('dashboard');
            },

            navigate(view) {
                // Handle Sidebar Active State
                document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
                event?.currentTarget?.classList.add('active');

                // Update Titles
                const titles = {
                    dashboard: ['Executive Dashboard', 'Real-time Organization Capability'],
                    compliance: ['Sovereign Compliance', 'B-BBEE & Skills Audit Scorecard'],
                    directory: ['Talent Wallets', 'Verified Employee Skill Records'],
                    inference: ['AI Inference Engine', 'Vector-based Skill Extraction'],
                    settings: ['System Configuration', 'Privacy & Integrations']
                };
                
                if(titles[view]) {
                    document.getElementById('page-title').innerText = titles[view][0];
                    document.getElementById('page-subtitle').innerText = titles[view][1];
                }

                // Inject View
                document.getElementById('app-view').innerHTML = Views[view]();

                // Init Charts if dashboard
                if(view === 'dashboard') this.renderChart();
            },

            renderChart() {
                const ctx = document.getElementById('skillChart');
                if(!ctx) return;
                
                new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['Python', 'Cloud Arch', 'Leadership', 'CyberSec', 'Data Science', 'Agile'],
                        datasets: [{
                            label: 'Org Capability',
                            data: [85, 70, 60, 40, 75, 90],
                            backgroundColor: 'rgba(245, 158, 11, 0.2)',
                            borderColor: '#f59e0b',
                            pointBackgroundColor: '#f59e0b'
                        }, {
                            label: 'Industry Avg',
                            data: [60, 60, 65, 55, 60, 70],
                            borderColor: '#52525b',
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                angleLines: { color: '#27272a' },
                                grid: { color: '#27272a' },
                                pointLabels: { color: '#a1a1aa' },
                                ticks: { display: false, backdropColor: 'transparent' }
                            }
                        },
                        plugins: { legend: { labels: { color: '#e4e4e7' } } }
                    }
                });
            }
        };

        App.init();
    </script>
</body>
</html>
